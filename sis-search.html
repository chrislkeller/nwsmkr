<!DOCTYPE html>

<!-- BEGIN DOC -->
<html lang="en">

<!-- BEGIN HEADER -->
<head>

<!-- BEGIN META -->
<meta charset="utf-8">
<title></title>
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="robots" content="" />
<meta name="author" content="nwsmkr, &#169; 2011">
<meta name="google-site-verification" content="#" />
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta name="viewport" content="initial-scale = 0.4, width=device-width, maximum-scale=0.6667, user-scalable=yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<!-- END META -->

<!-- BEGIN FAVICON/MOBILE TOUCH ICON -->
<link rel="shortcut icon" href="#">
<link rel="apple-touch-icon" href="#">
<!-- END FAVICON/MOBILE TOUCH ICON -->

<!-- BEGIN CSS  -->
<link rel="stylesheet" href="css/style.css">

<!--[if IE]>
<link rel="stylesheet" type="text/css" href="css/all-ie.css" />
<![endif]-->

<!-- END CSS  -->

<!-- BEGIN SCRIPTS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script type="text/javascript">

	$(document).ready(function(){

	var url='http://api.littlesis.org/entities.json?_key=6f1b1376ec9f3f00824c8523bd32ce9a3bfbe408%26q=';
	var query;

		$('button').click(function(){

		//get value in the search box and store it in the variable
		query=$("#query").val();
		
		//creates link for given relationships
		$('.relationships_link').live('click', function() {

		//creates unordered list beneath parent		
		var list_item = $(this).parent()
		
		var relationships = list_item.append("<ul></ul>")

		//queries the API for relationships			
		var relation_url = "proxy.php?url=http://api.littlesis.org/entity/" + $(this).attr('href') + "/relationships.json?_key=6f1b1376ec9f3f00824c8523bd32ce9a3bfbe408";

		$.getJSON(relation_url, function(json){

			//this is where we can loop through the results in the json object
			$.each(json.contents.Response.Data.Relationships.Relationship ,function(i, relationship){
		
				//adds the relationships as list items
				relationships.append("<li>" + relationship.description1  + "</li>")
			});

		});

          return false

		});
		
		//get the json file
        $.getJSON("proxy.php?url=" + url+query, function(json){
			
			$("#results").html("<ul></ul>")

				//this is where we can loop through the results in the json object
				$.each(json.contents.Response.Data.Entities.Entity, function(i, entity) {

					if (entity.primary_type != "Person") return

				//this is where we do what we want with the tweet
				$("#results ul").append(
				'<li><a class="relationships_link" href="'+entity.id+'">(ID: ' + entity.id + ') <strong>' + entity.name + '</strong>:</a>' + entity.description + '</li>');
              });
            });

          });
       });
</script>
<!-- END SCRIPTS -->

</head>
<!-- END HEADER -->

<!-- BEGIN BODY -->
<body>

<!-- PASS SEARCH QUERY TO API -->
<input type="text" id="query" /><button>Search</button><br />

<!-- DIV IN WHICH TO DISPLAY RESULTS -->
<div id="results"></div>

<!--
AFTER SEARCH RESULTS RETURNED, ALLOW USER TO SELECT OBJECT
ON SUBMIT, PASS ID OF SELECTED OBJECT TO API SEARCH OF RELATIONSHIPS
RETURN RELATIONSHIP RESULTS ON NEXT PAGE
 -->
<input type="button" name="Submit" value="Submit" />

</body>
<!-- END BODY -->

<!-- BEGIN GOOGLE ANALYTICS CODE -->
<script type="text/javascript">

</script>
<!-- END GOOGLE ANALYTICS CODE -->

</html>
<!-- END DOC -->